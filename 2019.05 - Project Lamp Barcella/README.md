# Project Lamp - Barcella Elettricittà
In May 2019 we presented the project at Elettricittà fair, organised by [Barcella Elettroforniture](https://www.barcella.it/) at the [Bergamo Exhibition Center](https://www.bergamofiera.it/). We did some improvements for the occasion: we realized a new Telegram bot, simpler and easier to use, and a new web app, to control the lamps also with a computer, using a web browser. Here you can find all you need to run the project. We used the same Arduino sketch made last year, so you can refer [here](link_to_fix).

![Raul and Cristian at the project fair booth](https://i.imgur.com/2YJMY7H.jpg)
_[Raul](https://github.com/Raul178) and [Cristian](https://github.com/cristianlivella) at the project fair booth._


## Setting up the server
``` bash
python3 -m venv env
source env/bin/activate
pip install -r requirements.txt
```
In _app.py_: edit ___BOT_TOKEN___ with your Telegram bot token, generated by [@BotFather](https://t.me/BotFather).  
If you want to use the web app outside localhost, insert in ___ALLOWED_IPS___ the IPs of the clients you want authorize.  
Please note that there isn't any kind of authentication system, the clients you insert here will have full control, and they can also get your Telegram bot token. This could be improved, but for our usage it was fine.  
Open _sqlite.db_ with an editor, like [that](https://sqliteonline.com/), and update the table _lamps_ according to the IPs of your Arduino.  

## Starting the server
``` bash
source env/bin/activate
python app.py &
python telegram.py &
```

## Setting up the client
``` bash
npm install
```
In _src/main.js_: edit ___SERVER_HOST___ with the IP of the server where app.py is running.

## Starting the client
``` bash
npm start               # allow only access from localhost
HOST=0.0.0.0 npm start  # allow access outside localhost
```
The client run on port 8080, so you can use it typing __http://[YOUR_IP]:8080__ in your web browser.
